"use strict";function ExchangeRatesController(){}angular.module("calculator",[]),angular.module("calculator").component("calculator",{templateUrl:"/calculator/calculator.template.html",controller:["$http",function CalculatorController($http){var self=this;$http.get("https://api.privatbank.ua/p24api/pubinfo?json&exchange&coursid=5").then(function(response){self.rates=response.data,self.rates.push({ccy:"UAH",buy:"1",sale:"1"}),self.rates.forEach(function(item){localStorage.setItem(item.ccy,item.buy)})}),self.convertCurrExpression=function(expression,curr){var arr=expression.trim().split(" "),convertedArr=arr.map(function(item){return"+"==item||"-"==item||"/"==item||"*"==item?item:"="==item?"":parseFloat(item)/parseFloat(curr)});return isNaN(convertedArr[convertedArr.length-1])?(convertedArr.pop(),convertedArr.join(" ")):convertedArr.join(" ")};var operationPressed=!1,resultPressed=!1;self.expression="",self.result="0",self.currMod="UAH",self.convert=function(currencyFrom,currencyTo,num){return num*(localStorage.getItem(currencyFrom)/localStorage.getItem(currencyTo))},self.updateCurrentCurrency=function(currency){self.result=self.expression=self.convert(self.currMod,currency,self.result),self.currMod=currency},self.digit=function(num){"0"===self.result||operationPressed?(self.result=num,self.expression+=self.result):resultPressed?(self.result=num,self.expression=self.result):(self.result+=num,self.expression+=num),operationPressed=!1,resultPressed=!1},self.clear=function(){self.result="0",self.expression="",operationPressed=!1,resultPressed=!1},self.operate=function(operand){operationPressed||(resultPressed?(self.expression=self.result+" "+operand+" ",resultPressed=!1):self.expression+=" "+operand+" ",operationPressed=!0)},angular.element(document).on("keyup",function(e){var appElement=document.querySelector("[ng-app=calculatorApp]");angular.element(appElement).scope().$apply(function(){if("+"==e.key||"-"==e.key||"/"==e.key||"*"==e.key)self.operate(e.key);else if(isNaN(e.key)&&"."!=e.key){if("Enter"==e.key||"="==e.key){if(""==self.expression)return;self.calcResult()}}else self.digit(e.key)})}),self.calcResult=function(){"0"==self.result&&""==self.expression||"-1"!=self.expression.search("=")||(self.result=eval(self.expression),self.expression+=" = ",resultPressed=!0)},self.getResult=function(expression){return eval(expression)},self.memoryArray=[],self.memoryStore=function(){self.expression&&(self.memoryArray.unshift(+self.result),resultPressed=!0)},self.memoryAdd=function(){if(self.expression)if(0==self.memoryArray.length)self.memoryArray.unshift(+self.result),resultPressed=!0;else if(self.memoryArray.length>1){self.memoryArray[self.memoryArray.length-1];self.memoryArray[self.memoryArray.length-1]+=+self.result}else self.memoryArray[0]+=+self.result},self.memorySubtract=function(){if(self.expression)if(0==self.memoryArray.length)self.memoryArray.unshift(+self.result),resultPressed=!0;else if(self.memoryArray.length>1){self.memoryArray[self.memoryArray.length-1];self.memoryArray[self.memoryArray.length-1]-=+self.result}else self.memoryArray[0]-=+self.result},self.memoryRecall=function(){self.expression&&0!=self.memoryArray.length&&(self.result=self.memoryArray[self.memoryArray.length-1])},self.memoryClear=function(){self.memoryArray=[]},self.memoryClearItem=function(i,array){array.splice(i,1)},self.addToMemoryItem=function(i,array,result){array[i]+=result},self.subtractToMemoryItem=function(i,array,result){array[i]-=result}}]}),angular.module("exchangeRates",[]),angular.module("exchangeRates").component("exchangeRates",{templateUrl:"/exchange-rates/exchange-rates.template.html",controller:ExchangeRatesController,bindings:{exchangeRatesData:"="}}),angular.module("roundNumbers",[]).filter("roundNumber",[function(){return function(num){return num.slice(0,5)}}]),angular.module("reverse",[]).filter("reverse",[function(){return function(array){return array.slice().reverse()}}]),angular.module("calculatorApp",["calculator","exchangeRates","roundNumbers","reverse"]);